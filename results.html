<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8">
  <title>Ù„ÛŒØ³Øª Ù†ØªØ§ÛŒØ¬ â€” Exam System</title>
  <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
  <div class="container">
    <div class="card">
      <h1>Ù†ØªØ§ÛŒØ¬ Ø¢Ø²Ù…ÙˆÙ† </h1>

      <!-- ğŸ” Ù†ÙˆØ§Ø± Ø¬Ø³ØªØ¬ÙˆÛŒ Ù†Ø§Ù… -->
      <div style="margin: 10px 0;">
        <input id="searchName" type="text" placeholder="Ø¬Ø³ØªØ¬ÙˆÛŒ Ù†Ø§Ù…..." 
               style="width: 100%; padding: 8px; font-size: 16px;">
      </div>

      <form method="get">
        <label>ÙÛŒÙ„ØªØ± Ø§Ø³ØªØ§Ù†</label>
        <select name="province" onchange="this.form.submit()">
          <option value="">Ù‡Ù…Ù‡ Ø§Ø³ØªØ§Ù†â€ŒÙ‡Ø§</option>
          {% for p in provinces %}
            <option value="{{ p }}" {% if selected_province==p %}selected{% endif %}>{{ p }}</option>
          {% endfor %}
        </select>
      </form>

      <table class="table" id="resultsTable">
        <tr>
          <th>Ù†Ø§Ù… Ùˆ Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ†</th>
          <th>Ø§Ø³ØªØ§Ù†</th>
          <th>Ø¯Ø±ØµØ¯</th>
          <th>ØªØ±Ø§Ø²</th>
          <th>Ø±ØªØ¨Ù‡ Ú©Ø´ÙˆØ±ÛŒ</th>
          <th>Ø±ØªØ¨Ù‡ Ø§Ø³ØªØ§Ù†ÛŒ</th>
          <th>Ù…Ø´Ø§Ù‡Ø¯Ù‡</th>
        </tr>
        {% for r in results %}
          <tr>
            <td>{{ r.student_name }}</td>
            <td>{{ r.province }}</td>
            <td>{{ r.score }}%</td>
            <td>{{ r.tazr }}</td>
            <td>{{ r.rank_national }}</td>
            <td>{{ r.rank_provincial }}</td>
            <td><a class="btn" href="/result/{{ r.id }}">Ù…Ø´Ø§Ù‡Ø¯Ù‡</a></td>
          </tr>
        {% endfor %}
      </table>

      <div style="margin-top:12px"><a class="btn" href="/dashboard">Ø¨Ø§Ø²Ú¯Ø´Øª</a></div>
    </div>
  </div>

  <!-- ğŸ” Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø¬Ø³ØªØ¬Ùˆ -->
  <script>
    const searchInput = document.getElementById("searchName");
    const table = document.getElementById("resultsTable");

    searchInput.addEventListener("keyup", function(){
      const filter = this.value.trim();
      const rows = table.getElementsByTagName("tr");

      for (let i = 1; i < rows.length; i++) {
        const td = rows[i].getElementsByTagName("td")[0];
        if (td) {
          const text = td.textContent || td.innerText;
          rows[i].style.display = text.includes(filter) ? "" : "none";
        }
      }
    });
  </script>

</body>
</html>